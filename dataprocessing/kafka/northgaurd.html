<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LinkedIn Northguard Engine</title>
    <style>
        :root {
            --bg: #050505;
            --panel: #111111;
            --kafka-blue: #0073b1;
            --ng-orange: #ff4c00;
            --success: #00ff9d;
            --danger: #ff0055;
            --text: #e0e0e0;
        }

        body {
            background-color: var(--bg);
            color: var(--text);
            font-family: 'Inter', system-ui, -apple-system, sans-serif;
            margin: 0; padding: 20px;
            overflow-x: hidden;
        }

        .container { max-width: 1200px; margin: 0 auto; }

        header { text-align: center; margin-bottom: 40px; }
        header h1 { color: var(--ng-orange); letter-spacing: 2px; margin-bottom: 5px; }
        header p { color: #888; }

        .dashboard { display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 30px; }

        .system-card {
            background: var(--panel);
            border: 1px solid #333;
            border-radius: 16px;
            padding: 25px;
            position: relative;
        }

        .kafka { border-top: 4px solid var(--kafka-blue); }
        .northguard { border-top: 4px solid var(--ng-orange); }

        .label { font-size: 0.7em; text-transform: uppercase; letter-spacing: 1px; color: #666; margin-bottom: 10px; }
        h2 { margin: 0 0 15px 0; font-size: 1.5em; }

        /* Simulation Track */
        .track {
            height: 120px;
            background: #000;
            border-radius: 8px;
            position: relative;
            overflow: hidden;
            border: 1px solid #222;
        }

        .segment {
            position: absolute;
            width: 40px;
            height: 60px;
            background: #1a1a1a;
            border-radius: 4px;
            top: 30px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.7em;
            font-weight: bold;
            transition: transform 0.1s linear;
        }

        .kafka-seg { border: 2px solid var(--kafka-blue); }
        .ng-seg { border: 2px solid var(--ng-orange); box-shadow: 0 0 10px rgba(255, 76, 0, 0.2); }

        .status-dot {
            width: 10px; height: 10px; border-radius: 50%; display: inline-block; margin-right: 8px;
        }

        /* Controls */
        .controls {
            display: flex; justify-content: center; gap: 20px; margin-top: 20px;
        }
        button {
            padding: 12px 24px; border-radius: 8px; border: none; cursor: pointer;
            font-weight: bold; font-family: inherit; transition: 0.3s;
        }
        .btn-stress { background: var(--danger); color: white; }
        .btn-reset { background: #333; color: white; }

        .stats { margin-top: 15px; display: flex; justify-content: space-between; font-family: monospace; }
        .lag { color: var(--danger); }
        .stable { color: var(--success); }

        /* Innovation List */
        .features {
            display: grid; grid-template-columns: repeat(3, 1fr); gap: 20px; margin-top: 40px;
        }
        .feature-box { background: #161616; padding: 20px; border-radius: 12px; border: 1px solid #222; }
        .feature-box h3 { color: var(--ng-orange); font-size: 1em; margin-top: 0; }
        .feature-box p { font-size: 0.85em; color: #aaa; line-height: 1.5; }

        @keyframes wobble {
            0% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
            100% { transform: translateX(0); }
        }
        .jitter { animation: wobble 0.1s infinite; }
    </style>
</head>
<body>

<div class="container">
    <header>
        <h1>NORTHGUARD x INFRA</h1>
        <p>The 32 Trillion Records/Day Engine replacing Apache Kafka at LinkedIn scale</p>
    </header>

    <div class="dashboard">
        <div class="system-card kafka">
            <div class="label">Legacy Infrastructure</div>
            <h2>Apache Kafka</h2>
            <div class="track" id="kafka-track">
                </div>
            <div class="stats">
                <span>Controller: <span id="k-ctrl">100% Load</span></span>
                <span>Lag: <span id="k-lag" class="stable">0ms</span></span>
            </div>
            <p style="font-size: 0.8em; color: #666; margin-top: 15px;">
                <b>Issue:</b> Partition-level replication. When one broker fails, massive data rebalancing causes "Stop-the-world" latency.
            </p>
        </div>

        <div class="system-card northguard">
            <div class="label">Next-Gen Log Storage</div>
            <h2>Northguard</h2>
            <div class="track" id="ng-track">
                </div>
            <div class="stats">
                <span>Sharded Metadata: <span id="ng-ctrl">Stable</span></span>
                <span>Stability: <span id="ng-lag" class="stable">100%</span></span>
            </div>
            <p style="font-size: 0.8em; color: #666; margin-top: 15px;">
                <b>Innovation:</b> Segment-level log striping. Distributes 1GB segments across brokers automatically. No manual rebalancing.
            </p>
        </div>
    </div>

    <div class="controls">
        <button class="btn-stress" onclick="toggleStress()">STRESS TEST (SIMULATE BROKER FAILURE)</button>
        <button class="btn-reset" onclick="resetSim()">RESET ENGINE</button>
    </div>

    <div class="features">
        <div class="feature-box">
            <h3>Log Striping</h3>
            <p>Instead of replicating entire partitions, Northguard stripes logs across disks, maximizing throughput and reducing single-storage failures.</p>
        </div>
        <div class="feature-box">
            <h3>Decentralized Metadata</h3>
            <p>Replaces the single Kafka controller with a Sharded Raft-backed State Machine. Supports millions of replicas with ease.</p>
        </div>
        <div class="feature-box">
            <h3>xInfra Virtualization</h3>
            <p>A unified Pub/Sub layer that spans Kafka and Northguard. Enables zero-downtime migration for 90% of LinkedIn's apps.</p>
        </div>
    </div>
</div>

<script>
    const kafkaTrack = document.getElementById('kafka-track');
    const ngTrack = document.getElementById('ng-track');
    const kLag = document.getElementById('k-lag');
    const ngLag = document.getElementById('ng-lag');
    const kCtrl = document.getElementById('k-ctrl');
    
    let isStressed = false;
    let frame = 0;
    let kSegments = [];
    let nSegments = [];

    function createSegment(type) {
        const seg = document.createElement('div');
        seg.className = `segment ${type}-seg`;
        seg.innerText = type === 'kafka' ? 'PART' : 'SEG';
        seg.style.left = '100%';
        (type === 'kafka' ? kafkaTrack : ngTrack).appendChild(seg);
        return { el: seg, pos: 100 };
    }

    function toggleStress() {
        isStressed = !isStressed;
        if (isStressed) {
            kLag.innerText = 'HIGH LAG (REBALANCING)';
            kLag.className = 'lag';
            kCtrl.innerText = 'CRITICAL OVERLOAD';
            kCtrl.style.color = 'var(--danger)';
            kafkaTrack.classList.add('jitter');
        } else {
            resetUI();
        }
    }

    function resetUI() {
        kLag.innerText = '0ms';
        kLag.className = 'stable';
        kCtrl.innerText = '100% Load';
        kCtrl.style.color = 'inherit';
        kafkaTrack.classList.remove('jitter');
    }

    function resetSim() {
        isStressed = false;
        resetUI();
        kafkaTrack.innerHTML = '';
        ngTrack.innerHTML = '';
        kSegments = [];
        nSegments = [];
    }

    function update() {
        frame++;
        
        // Spawn
        if (frame % 20 === 0) kSegments.push(createSegment('kafka'));
        if (frame % 20 === 0) nSegments.push(createSegment('ng'));

        // Move Kafka
        kSegments.forEach((s, i) => {
            // Under stress, Kafka segments slow down or cluster up (lag)
            let speed = isStressed ? 0.2 : 0.8;
            s.pos -= speed;
            s.el.style.left = s.pos + '%';
            if (s.pos < -10) {
                s.el.remove();
                kSegments.splice(i, 1);
            }
        });

        // Move Northguard
        nSegments.forEach((s, i) => {
            // Northguard remains stable regardless of stress
            s.pos -= 0.8;
            s.el.style.left = s.pos + '%';
            if (s.pos < -10) {
                s.el.remove();
                nSegments.splice(i, 1);
            }
        });

        requestAnimationFrame(update);
    }

    update();
</script>

</body>
</html>
